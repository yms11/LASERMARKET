<!DOCTYPE html>
<html lang="ko-KR">
  
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>레이저마켓 견적</title>
  <style>
    /* table,
    td {
      border: 1px solid black;
    } */
	/*구글 웹 폰트 적용*/
	@import url(//fonts.googleapis.com/earlyaccess/jejumyeongjo.css);

	.jm-font{
		font-family: 'Jeju Myeongjo', serif;/*웹 폰트 지정*/
		color: orange;
	}
    table,
    th,
    td {
      border: 1px solid black;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 5px;
      text-align: left;
    }


    .main_inner_background {
      background-color: lightblue;
      width: 150px;
      height: 75px;
    }


    .main_Text {
      display: inline-block;
      width: 150px;
      height: 75px;

      font-size: 20px;
      text-align: center;
    }

    #Table_Right {
  border-collapse: collapse;
  text-align: left;
  line-height: 1.5;

}
  #Table_Right thead th {
  padding: 10px;
  font-weight: bold;
  vertical-align: top;
  color: #369;
  border-bottom: 3px solid #036;
}
  #Table_Right tbody th {

  padding: 10px;
  font-weight: bold;
  vertical-align: top;
  border-bottom: 1px solid #ccc;
  background: #f3f6f7;
}
  #Table_Right td {

  padding: 10px;
  vertical-align: top;
  border-bottom: 1px solid #ccc;
}

button{
  background:#1AAB8A;
  color:#fff;
  border:none;
  position:relative;
  height:60px;
  font-size:1.6em;
  padding:0 2em;
  cursor:pointer;
  transition:800ms ease all;
  outline:none;
}
button:hover{
  background:#fff;
  color:#1AAB8A;
}
button:before,button:after{
  content:'';
  position:absolute;
  top:0;
  right:0;
  height:2px;
  width:0;
  background: #1AAB8A;
  transition:400ms ease all;
}
button:after{
  right:inherit;
  top:inherit;
  left:0;
  bottom:0;
}
button:hover:before,button:hover:after{
  width:100%;
  transition:800ms ease all;
}


  </style>
  <script src="table2excel.js"></script>
  <script lang="javascript" src="dist/xlsx.full.min.js"></script>
  <script src="html2canvas.js"></script>
</head>
<header style="text-align: center; font-size: 40px;">제작 금액 견적 알아보기</header>

<!-- <body style="background-color:#F7F8B1;"> -->
  <body>

  <!--   
<p>lasermarket11@gmail.com</p>
<p>국민 512001-04-444197</p>
<p>3.2T 이상 절곡 요청시, 최소 외장길이 10cm 이상만 가능</p>
<p>최대 크기 1219*2438mm 이하</p>
<p>1cm 10mm</p>
<p>10cm 100mm</p> -->



  <div class="main" style="width: 100%;">
    <div class="left_main" style="border:  1px solid blue; float: left; width: 45%; min-width: 700px; margin-top: 20px;">
      <div style="float: left; margin-top: 20px">
        <div class="div_material_type_text main_Text" style="float: left;">재질</div>
        <div class="div_material_type main_Text">
          <select onchange="doSomething_Version_2(this)" id="select_material_type" style="font-size: 20px; width: 100%; height: 95%;
          text-align-last: center; font-weight: bold;
   text-align: center;
   -ms-text-align-last: center;
   -moz-text-align-last: center;">
            <option value="NONE">재질선택</option>
            <option value="SS400">SS400</option>
            <option value="ATOS80">ATOS80(ATOS780)</option>
            <option value="S45C">S45C</option>
            <option value="SUS-1D">SUS-1D</option>
            <option value="SUS-2B">SUS-2B</option>
            <option value="SUS-HL">SUS-HL</option>
            <option value="SUS-PL">SUS-PL</option>
            <option value="AL">AL</option>" +
            <option value="AL-CK">AL-CK</option>";
          </select>

        </div>
      </div>
      <div style="float: left; margin-top: 20px;">
        <div class="main_3 main_Text" style="float: left;">두께</div>
        <div class="main_4 main_Text">
          <select id="select_thick" style="font-size: 20px; width: 100%; height: 95%; font-weight: bold;
          text-align-last: center;
   text-align: center;
   -ms-text-align-last: center;
   -moz-text-align-last: center;">

          </select>
        </div>
      </div>
      <div style="clear: both; ">


        <div style="float: left; margin-top: 20px;">
          <div class="div_material_type_text main_Text" style="float: left;">가로(mm)</div>
          <div class="div_material_type main_Text" style="float: left;">
            <input id="input_size_x" type="number" min="0" step="1" style="width: 95%;   height: 95%; background-color: lightcyan;
            font-size:20px; font-weight: bold; text-align: center;" />
          </div>
        </div>
        <div style="float: left; margin-top: 20px;">

          <div class="main_3 main_Text" style="float: left;">세로(mm)</div>
          <div class="main_4 main_inner_background" style="float: left;">
            <input type="number" min="0" step="1" id="input_size_y" style="width: 95%; font-weight: bold; height: 95%;  background-color: lightcyan;
               font-size:20px; text-align: center;" />
          </div>
        </div>
      </div>
      <div style="float: left; margin-top: 20px;">
        <div style="float: left;">
          <div class="div_material_type_text main_Text" style="float: left;">총 수량</div>
          <div class="div_material_type main_Text" style="float: left;">
            <input id="input_count" type="number" min="0" step="1" style="width: 95%; font-weight: bold; height: 95%; background-color: lightcyan;
               font-size:20px; text-align: center;" />
          </div>
        </div>
        <div style="float: left;">
          <div style=" float: left; width: 100%;" class="main_3">
            <button onclick="GetData()" style="width: 280px; height: 65px; font-size: 20px; font-weight: bold; 
            margin-left: 20px; margin-top: 11px; ">
              계산 금액 확인하기
            </button>
            
          </div>
        </div>



      </div>
      <div class="div_main_other" style="clear: both;  margin-top: 50px;">
        <div style="margin-top: 20px;">
          <pre id="pre_output" style="margin-top: 30px; font-size: 20px;">

        </pre>
        </div>

        <div style="width:800px; margin:20px;">
          <pre style="float: left; font-size: 20px;">네이버 주문 수량은</pre>
          <button style="float: left; font-size: 20px; height: 50px;">-</button>
          <input id="input_naverpay" style="float: left; 
           font-size: 20px; font-weight: bold; width: 50px; height: 45px;" type="number" height="40px" width="50" min="0" step="1" />
          <button style="float: left; font-size: 20px; height: 50px;">+</button>
          <pre style="float: left; font-size: 20px; "> 입니다 </pre>
        </div>

      </div>
    </div>
    <div id="right_main" class="right_main" style="float: left; width: 45%; min-width : 700px; margin: 20px;">
      <div class="my-box" style="border: 1px solid black; float: left; width: 100%;">

        <pre class="my-box" style="border: 1px solid black; float: left; width: 40%;
          text-align: center;
          font-size: 20px; 
          text-align: left;">
            <b>견적서</b>
            </pre>

        <div class="my-box" style="border: 0px solid gold; float: left; width: 59%;">
          <table id="" style="width: 95%; margin:auto">

            <thead>
              <tr>
                <th>공급자</th>
              </tr>
              <tr>
                <td> 등 록 번 호 : 533-06-01928 <br>
                  상 호 : 레이저 마켓 성명 : 조민영 <br>
                  <!-- 주 소 : 전북 김제시 백구면 석담4길 131-9 <br> -->
                  T.(063) 291 - 3000 F:214 - 3000 <br>
                  E -mail : lasermarket11@naver.com</td>
              </tr>

            </thead>
          </table>
        </div>

        <hr style="height:0px;border-width:0;width: 95%; color:gray;background-color:gray" />

        <pre pre id="right_time_text" style="width: 100%; text-align:center; 
        border-top: 1px dotted red;">
         
             </pre>


            
        <table id="Table_Right" style="width: 95%; margin:auto">

          <thead>

          <tr>
            <th id ="col_No">No</th>
            <th id ="col_type_thick" >재질.두께</th>
            <th id ="col_size">규격</th>
            <th id ="col_count">수량</th>
            <th id ="col_ea">단위</th>
            <th id ="col_price">단가</th>
            <th id ="col_all_price">공급가액</th>
            <th id ="col_naver">네이버<br>주문수량</th>
            <th></th>
          </tr>

</thead>
          <tr>
            <td colspan="3">TOTAL</td>
            <td colspan="1">0</td>
            <td></td>
            <td>\</td>
            <td>-</td>
            <td>-</td>
          </tr>


        </table>

        <button style="margin: 5px; float: left;" type="button" id ="excelFileExport" >견적서 출력</button>

        <!-- 파일 내보내기(HTML TABLE) : <input type="button" id="excelFileExport" value="엑셀 파일 다운로드(TABLE) 사용불가 TEST" /> -->
        <button style="margin: 5px; float: left;" type="button" onclick="window.open('https://smartstore.naver.com/lasermarket11/products/5351160682')">주문하러가기</button>
      
        
      </div>

    <b  text-align: center> COPYRIGHT ⓒ 2021 YMS ALL RIGHTS RESERVED.  </b>
  
    </div>
  </div>


  <!-- <button type="button" style="width: 100%;font-size : 20px; background-color: blanchedalmond;" onclick="myFunction()">
    항목 추가 </button>

  <table id="myTable" style="width: 100%;">
    <tr>
      <th width="10%">① 재질</th>
      <th width="10%">② 두께</th>
      <th width="10%">③ 가로</th>
      <th width="10%">④ 세로</th>
      <th width="10%">⑤ 수량</th>
      <th width="5%"></th>
    </tr>
  </table>
  <br>
  <button id="btn_estimate" class="favorite styled"
    style="width: 100%;font-size : 20px; background-color: blanchedalmond; margin-bottom: 20px;" type="button"
    onclick="CheckEstimate()">
    견적확인
  </button>
  <br>

  <div style="border: 1px solid ; float: left; width: 100%;">
    <div style="border: 0px solid ;  width: 50%; 
  max-width: 50%;
   min-width: 700px;">

      <div class="my-box" style="border: 1px solid gold; float: left; width: 100%;">

        <pre class="my-box" style="border: 1px solid black; float: left; width: 40%;
        text-align: center;
        font-size: 20px; 
        text-align: left;">
          <b>레이저 마켓</b>
          </pre>
        <div class="my-box" style="border: 0px solid gold; float: left; width: 59%;">
          <table style="width:100%">
            <tr>
              <th>상호명</th>
              <td>레이저 마켓</td>
            </tr>
            <tr>
              <th>사업자등록번호</th>
              <td>5330000000</td>
            </tr>
            <tr>
              <th>통신판매업번호</th>
              <td>2021-전주완산-0095</td>
            </tr>
            <tr>
              <th>고객센터 </th>
              <td>063-291-3000</td>
            </tr>
          </table>
        </div>

        <hr style="height:0px;border-width:0;width: 95%; color:gray;background-color:gray" />

        <pre style="width: 100%; text-align:center;">
   인 터 넷 쇼 핑 몰 https://smartstore.naver.com/lasermarket11
      </pre>

        <pre id="left_time_text" style="width: 100%; text-align:center; 
      border-top: 1px dotted red;">
        2021-07-26 11:55
           </pre>



        <table id="Table_Left" style="width: 95%; margin:auto">


          <tr>
            <th>철판 소재명</th>
            <th>주문크기</th>
            <th>네이버 주문수량</th>
          </tr>





        </table>
        <hr style="height:2px;border-width:0;width: 95%; color:gray;background-color:gray" />
        <div style="width: 95%;">
          <pre style="float: left;
        font-size: 20px;"> <b> 합   계</b></pre>
          <pre id="left_total_bill" style="float: right;
        font-size: 20px;"><b>\0</b> </pre>
        </div>
        <hr style="height:2px;border-width:0;width: 95%; color:gray;background-color:gray" />
        <pre style="width: 100%; text-align:center;">
        주문 제작 방식으로 평일 기준 3~5일 작업시간이 소요되며
        구매 가능 두께는 당사 사정으로 변경될 수 있으며 사전 안내 드리고 있습니다.
   (세부사항 https://smartstore.naver.com/lasermarket11 참조)
      </pre>
        <hr style="height:2px;border-width:0;width: 95%; color:gray;background-color:gray" />


      </div>


    </div>


    <div style="border: 0px solid ;  width: 50%; 
      max-width: 49%; float: left;
       min-width: 700px;">

      <div class="my-box" style="border: 1px solid gold; float: left; width: 100%;">

        <pre class="my-box" style="border: 1px solid black; float: left; width: 40%;
            text-align: center;
            font-size: 20px; 
            text-align: left;">
              <b>견적서</b>
              </pre>

        <div class="my-box" style="border: 0px solid gold; float: left; width: 59%;">
          <table id="" style="width: 95%; margin:auto">

            <thead>
              <tr>
                <th>공급자</th>
              </tr>
              <tr>
                <td> 등 록 번 호 : 533-06-01928 <br>
                  상 호 : 레이저 마켓 성명 : 조민영 <br>
                  주 소 : 전북 김제시 백구면 석담4길 131-9 <br>
                  T.(063) 291 - 3000 F:214 - 3000 <br>
                  E -mail : lasermarket11@naver.com</td>
              </tr>

            </thead>
          </table>
        </div>

        <hr style="height:0px;border-width:0;width: 95%; color:gray;background-color:gray" />

        <pre pre id="right_time_text_2" style="width: 100%; text-align:center; 
          border-top: 1px dotted red;">
            2021-07-26 11:55
               </pre>



        <table id="Table_Right_2" style="width: 95%; margin:auto">


          <tr>
            <th>No</th>
            <th>재질.두께</th>
            <th>규격</th>
            <th>수량</th>
            <th>단위</th>
            <th>단가</th>
            <th>공급가액</th>
            <th>비고</th>

          </tr>


          <tr>
            <td colspan="3">TOTAL</td>
            <td colspan="1">0</td>
            <td></td>
            <td>\</td>
            <td>-</td>

          </tr>


        </table>

      </div>


    </div>
  </div> -->


  <script>
    var iTotalPay = 0;

    //yFunction();
    //myFunction();
    //myFunction();
    //   myFunction();
    //   myFunction();
    //  myFunction();
    // myFunction();
    function numberWithCommas(x) {
      return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    function SetRightTableTotal() {
      try {
        iTotalPay = 0;
        var total_count = 0;
        var total_payment = 0;
        var total_naver_count = 0;
        var product_price = 0;
        var table = document.getElementById('Table_Right');
        for (var r = 1, n = table.rows.length - 1; r < n; r++) {
          for (var c = 0, m = table.rows[r].cells.length - 1; c < m; c++) {

            if (c == 3) {
              total_count += parseInt(table.rows[r].cells[c].innerHTML);
              //alert(total_count);
            }

            if (c == 6) {
              // numberWithCommas(table.rows[r].cells[c].innerHTML);
              total_payment += parseInt(table.rows[r].cells[c].innerHTML.replace(",", ""));
              //alert(total_payment);
            }
            if (c == 5) {
              // numberWithCommas(table.rows[r].cells[c].innerHTML);
              product_price += parseInt(table.rows[r].cells[c].innerHTML.replace(",", ""));
              //alert(total_payment);
            }

            if (c == 7) {
              total_naver_count += parseInt(table.rows[r].cells[c].innerHTML);
              // alert(total_naver_count);
            }

          }
        }
        iTotalPay = total_payment;
        //      var tmp = table.rows.length-2;
        //alert(table.row[tmp].cells.length);

        table.rows[table.rows.length - 1].cells[1].innerHTML = "<td>" + String(addComma(total_count)) + "</td>";
        table.rows[table.rows.length - 1].cells[2].innerHTML = "<td>" + "EA" + "</td>";
        table.rows[table.rows.length - 1].cells[3].innerHTML = "<td>" + "\\" + String(addComma(product_price)) + "</td>";
        table.rows[table.rows.length - 1].cells[4].innerHTML = "<td>" + "\\" + String(addComma(total_payment)) + "</td>";
       
        table.rows[table.rows.length - 1].cells[5].innerHTML = "<td>" + String(addComma(total_naver_count)) + "</td>";
      } catch (error) {
        alert(error);
      }

    }

    function doSomething_Version_2(a) {
      try {

        //@@ 두께 입력 란
        var var_Width = "";
        var var_Height = "";
        var var_Thick = "";

        //선택된값
        var selectedItem = a.options[a.selectedIndex];
        //  alert(selectedItem.value);
        switch (String(selectedItem.value)) {
          case 'SS400':
            var_Thick += "<option value='1.6'>1.6</option>";
            var_Thick += "<option value='2'>2</option>";
            var_Thick += "<option value='3'>3</option>";
            var_Thick += "<option value='3.2'>3.2</option>";
            var_Thick += "<option value='4'>4</option>";
            var_Thick += "<option value='4.5'>4.5</option>";
            var_Thick += "<option value='6'>6</option>";
            var_Thick += "<option value='9'>9</option>";


            break;
          case 'ATOS80':

            var_Thick += "<option value='3.2'>3.2</option>";
            var_Thick += "<option value='4.5'>4.5</option>";
            var_Thick += "<option value='6'>6</option>";
            var_Thick += "<option value='8'>8</option>";
            var_Thick += "<option value='10'>10</option>";
            var_Thick += "<option value='12'>12</option>";


            break;
          case 'S45C':
            var_Thick += "<option value='1.2'>1.2</option>";
            break;
          case 'SUS-1D':

            var_Thick += "<option value='3'>3</option>";
            var_Thick += "<option value='4'>4</option>";
            var_Thick += "<option value='5'>5</option>";
            var_Thick += "<option value='6'>6</option>";
            var_Thick += "<option value='8'>8</option>";
            var_Thick += "<option value='12'>12</option>";

            break;
          case 'SUS-2B':

            var_Thick += "<option value='1'>1</option>";
            var_Thick += "<option value='1.2'>1.2</option>";
            var_Thick += "<option value='1.5'>1.5</option>";
            var_Thick += "<option value='2'>2</option>";

            break;
          case 'SUS-HL':
            var_Thick += "<option value='1'>1</option>";
            var_Thick += "<option value='1.5'>1.5</option>";
            var_Thick += "<option value='2'>2</option>";
            break;
          case 'SUS-PL':
            var_Thick += "<option value='1'>1</option>";
            var_Thick += "<option value='1.5'>1.5</option>";
            var_Thick += "<option value='2'>2</option>";
            break;
          case 'AL':
            var_Thick += "<option value='2'>2</option>";
            var_Thick += "<option value='3'>3</option>";
            break;

          case 'AL-CK':
            var_Thick += "<option value='2'>2</option>";
            break;
        }
        var thick_select = document.getElementById('select_thick');

        thick_select.innerHTML = var_Thick;

        // var col_thick = a.parentNode.parentNode.cells[1];
        // var col_width = a.parentNode.parentNode.cells[2];
        // var col_height = a.parentNode.parentNode.cells[3];
        // col_thick.innerHTML = "<select width='50'>" +
        //   var_Thick + "</select>";




      } catch (error) {
        alert("ERROR" + error);
      }

    }
    function doSomething(a) {
      try {

        //@@ 두께 입력 란
        var var_Width = "";
        var var_Height = "";
        var var_Thick = "";

        //선택된값
        var selectedItem = a.options[a.selectedIndex];
        // alert(selectedItem.value);
        switch (String(selectedItem.value)) {
          case 'SS400':
            var_Thick += "<option value='1.6'>1.6</option>";
            var_Thick += "<option value='2'>2</option>";
            var_Thick += "<option value='3'>3</option>";
            var_Thick += "<option value='3.2'>3.2</option>";
            var_Thick += "<option value='4'>4</option>";
            var_Thick += "<option value='4.5'>4.5</option>";
            var_Thick += "<option value='6'>6</option>";
            var_Thick += "<option value='9'>9</option>";


            break;
          case 'ATOS80':

            var_Thick += "<option value='3.2'>3.2</option>";
            var_Thick += "<option value='4.5'>4.5</option>";
            var_Thick += "<option value='6'>6</option>";
            var_Thick += "<option value='8'>8</option>";
            var_Thick += "<option value='10'>10</option>";
            var_Thick += "<option value='12'>12</option>";


            break;
          case 'S45C':
            var_Thick += "<option value='1.2'>1.2</option>";
            break;
          case 'SUS-1D':

            var_Thick += "<option value='3'>3</option>";
            var_Thick += "<option value='4'>4</option>";
            var_Thick += "<option value='5'>5</option>";
            var_Thick += "<option value='6'>6</option>";
            var_Thick += "<option value='8'>8</option>";
            var_Thick += "<option value='12'>12</option>";

            break;
          case 'SUS-2B':

            var_Thick += "<option value='1'>1</option>";
            var_Thick += "<option value='1.2'>1.2</option>";
            var_Thick += "<option value='1.5'>1.5</option>";
            var_Thick += "<option value='2'>2</option>";

            break;
          case 'SUS-HL':
            var_Thick += "<option value='1'>1</option>";
            var_Thick += "<option value='1.5'>1.5</option>";
            var_Thick += "<option value='2'>2</option>";
            break;
          case 'SUS-PL':
            var_Thick += "<option value='1'>1</option>";
            var_Thick += "<option value='1.5'>1.5</option>";
            var_Thick += "<option value='2'>2</option>";
            break;
          case 'AL':
            var_Thick += "<option value='2'>2</option>";
            var_Thick += "<option value='3'>3</option>";
            break;

          case 'AL-CK':
            var_Thick += "<option value='2'>2</option>";
            break;
        }

        var col_thick = a.parentNode.parentNode.cells[1];
        var col_width = a.parentNode.parentNode.cells[2];
        var col_height = a.parentNode.parentNode.cells[3];
        col_thick.innerHTML = "<select width='50'>" +
          var_Thick + "</select>";




      } catch (error) {
        alert("ERROR" + error);
      }

    }
    function getCurrentDate() {
      var date = new Date();
      var year = date.getFullYear().toString();

      var month = date.getMonth() + 1;
      month = month < 10 ? '0' + month.toString() : month.toString();

      var day = date.getDate();
      day = day < 10 ? '0' + day.toString() : day.toString();

      var hour = date.getHours();
      hour = hour < 10 ? '0' + hour.toString() : hour.toString();

      var minites = date.getMinutes();
      minites = minites < 10 ? '0' + minites.toString() : minites.toString();

      var seconds = date.getSeconds();
      seconds = seconds < 10 ? '0' + seconds.toString() : seconds.toString();

      return year + "-" + month + "-" + day + " " + hour + ":" + minites + ":" + seconds;
    }

    function CheckEstimate() {

      try {
        var AllPayValue = 0;
        var tableHeaderRowCount = 1;
        var table = document.getElementById('Table_Left');
        var rowCount = table.rows.length;
        for (var i = tableHeaderRowCount; i < rowCount; i++) {
          table.deleteRow(tableHeaderRowCount);
        }
        var tableHeaderRowCount = 1;
        var table = document.getElementById('Table_Right');
        var rowCount = table.rows.length;
        for (var i = tableHeaderRowCount; i < rowCount - 1; i++) {
          table.deleteRow(tableHeaderRowCount);
        }

        var var_time = getCurrentDate();//;
        document.getElementById('left_time_text').innerHTML = var_time;
        document.getElementById('right_time_text').innerHTML = var_time;



        var testTable = document.getElementById('myTable');
        //alert(testTable.rows.length);

        for (i = 1; i < testTable.rows.length; i++) {

          var material_type = null;
          var material_size_x = null;
          var material_size_y = null;
          var material_size_t = null;
          var material_count = null;

          //값 다 채워지면
          var isValueOK = new Boolean(true);
          var recordcells = testTable.rows.item(i).cells;
          for (var j = 0; j < recordcells.length; j++) {


            //콤보박스 선택 됐을때만
            var isSelected = recordcells.item(0).getElementsByTagName("select")[0].value;
            //alert(isSelected);
            if (isSelected != "NONE") {
              var record;
              if (j == 0 || j == 1) {

                record = recordcells.item(j).getElementsByTagName("select")[0].value;
              }
              else if (j == 5) {

              }
              else {

                record = recordcells.item(j).getElementsByTagName("input")[0].value;

                if (String(record.length) == 0) {
                  isValueOK = Boolean(false);
                }
              }


              switch (j) {
                case 0:
                  material_type = record;

                  break;
                case 1:
                  material_size_t = record;

                  break;
                case 2:
                  material_size_x = record;

                  break;
                case 3:
                  material_size_y = record;

                  break;
                case 4:
                  material_count = record;

                  break;

              }

            }
            else {

              isValueOK = Boolean(false);

            }




            //Now you can add this record as per your required format (list or in json format)
          }

          if (isValueOK) {
            var var_material_type = String(material_type).concat(" ", String(material_size_t), "T");
            var material_size = material_size_x + " x " + material_size_y;

            var PayValue = FuncPayment(material_type, material_size_t, material_size_x, material_size_y, material_count);
            PayValue = Math.ceil(PayValue);
            //  alert(PayValue);
            var NaverCount = Math.ceil(PayValue / 100);

            //  alert(i);
            //  alert("MAKE");
            LeftTableInert(var_material_type, material_size, NaverCount);
            RightTableInert(var_material_type, material_size, material_count, PayValue);

            AllPayValue += NaverCount;

          }
        }

        document.getElementById('left_total_bill').innerHTML = '<b>\\' + (AllPayValue * 100) + "<b>";

      } catch (error) {
        alert("ERROR" + error);
      }


    }

    function GetData() {
      try {
        var Material_x = document.getElementById('input_size_x').value;
        var Material_y = document.getElementById('input_size_y').value;

        var select_t = document.getElementById('select_thick');
        var Material_t = select_t.options[select_t.selectedIndex].value;

        var select_type = document.getElementById('select_material_type');
        var Material_Type_name = select_type.options[select_type.selectedIndex].value;
        var Material_count = document.getElementById('input_count').value;

        // alert(Material_x);
        // alert(Material_y);
        // alert(Material_t);
        // alert(Material_Type_name);
        // alert(Material_count);


        var Payment = FuncPayment_Version_2(Material_Type_name, Material_t, Material_x, Material_y, Material_count);
      //  Payment =  Math.ceil(Payment / 100) * 100;
      Payment =  Math.ceil(Payment/100) * 100;
        var NaverPayment = Math.ceil(Payment / 100);
        var commaValue = addComma(Payment);
        var output_text = Material_Type_name + "/ 두께 " + Material_t + "/" + Material_x + "x" + Material_y + "/ 수량 " + Material_count + " 개의 결제금액은" +
          "<b> " + commaValue + "</b>" + " 원 입니다.";

        document.getElementById('pre_output').innerHTML = output_text;



        document.getElementById('input_naverpay').value = NaverPayment;//.toLocaleString('ko-KR');  

        var material_type_thick = Material_Type_name + " " + Material_t + "T";
        var material_size = Material_x + "x" + Material_y;
        RightTableInert(material_type_thick, material_size, NaverPayment, commaValue, Material_count);
        SetRightTableTotal();


        var var_time = getCurrentDate();
        document.getElementById('right_time_text').innerHTML = var_time;

        //alert(Payment);
      } catch (error) {
        alert(error);
      }


    }

    function addComma(value) {
      var num = isNumber(value);
      if (!num) return;

      // 문자열 길이가 3과 같거나 작은 경우 입력 값을 그대로 리턴
      if (num.length <= 3) {
        return num;
      }

      // 3단어씩 자를 반복 횟수 구하기
      var count = Math.floor((num.length - 1) / 3);

      // 결과 값을 저정할 변수
      var result = "";

      // 문자 뒤쪽에서 3개를 자르며 콤마(,) 추가
      for (var i = 0; i < count; i++) {

        // 마지막 문자(length)위치 - 3 을 하여 마지막인덱스부터 세번째 문자열 인덱스값 구하기
        var length = num.length;
        var strCut = num.substr(length - 3, length);
        // 반복문을 통해 value 값은 뒤에서 부터 세자리씩 값이 리턴됨.

        // 입력값 뒷쪽에서 3개의 문자열을 잘라낸 나머지 값으로 입력값 갱신
        num = num.slice(0, length - 3);

        // 콤마(,) + 신규로 자른 문자열 + 기존 결과 값
        result = "," + strCut + result;
      }

      // 마지막으로 루프를 돌고 남아 있을 입력값(value)을 최종 결과 앞에 추가
      result = num + result;

      // 최종값 리턴
      return result;
    }

    // 숫자 유무 판단
    function isNumber(checkValue) {
      checkValue = '' + checkValue;
      if (isNaN(checkValue) || checkValue == "") {
        alert('숫자만 입력해 주세요!!!');
        return;
      }
      return checkValue;
    }

    function FuncPayment_Version_2(material_type, material_size_t, material_size_x, material_size_y, material_count) {


      //계산수식_21_10_15
      var iCutCost = 0; //재단비
      var iSalePrice = 0; //판재금액
      var iMaterialPrice = 0; // 자재비? 고정비? 
      var dSpecific_gravity = 0; //철 비중
      var iStaticValue = 0; // 고정금액
      var iWeighted = 0; //가로,세로 가중치


      switch (material_type) {
        case 'SS400':
          iMaterialPrice = 3000;
          iStaticValue = 2000;
          iWeighted = 20;
          dSpecific_gravity = 7.85;
          break;
        case 'ATOS80':
          iMaterialPrice = 3000;
          iStaticValue = 3000;
          iWeighted = 20;
          dSpecific_gravity = 7.85;
          break;
        case 'S45C':
          iMaterialPrice = 3000;
          iStaticValue = 3000;
          iWeighted = 20;
          dSpecific_gravity = 7.85;
          break;
        case 'SUS-1D':
          iMaterialPrice = 1000;
          iStaticValue = 11900;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'SUS-2B':
          iMaterialPrice = 1000;
          iStaticValue = 10000;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'SUS-HL':
          iMaterialPrice = 1000;
          iStaticValue = 11000;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'SUS-PL':
          iMaterialPrice = 1000;
          iStaticValue = 12500;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'AL':
          break;
          iMaterialPrice = 1000;
          iStaticValue = 34000;
          iWeighted = 20;
          dSpecific_gravity = 2.75;
        case 'AL-CK':
          iMaterialPrice = 1000;
          iStaticValue = 40000;
          iWeighted = 20;
          dSpecific_gravity = 2.75;
          break;
      }

      iCutCost = iMaterialPrice * material_count;
   ; 
      // alert("material_size_x : " + material_size_x +"\n"+
      // "material_size_y : " + material_size_y + "\n"+
      // "material_size_t : " + material_size_t + "\n"+
      // "material_count : " + material_count + "\n"+
      // "iWeighted : " + iWeighted + "\n"+
      // "dSpecific_gravity : " + dSpecific_gravity + "\n"+ "\n"+
      // "iStaticValue : " + iStaticValue + "\n");


      material_size_x = parseInt(material_size_x) + iWeighted;
      material_size_y = parseInt(material_size_y) + iWeighted;
      iSalePrice = material_size_x * material_size_y * material_size_t * dSpecific_gravity * material_count / 1000000 * iStaticValue;
   

      //만원이상
      if (iCutCost > 10000) {
        iCutCost = 0;
      }


      return iCutCost + iSalePrice;
    }

    function FuncPayment(material_type, material_size_t, material_size_x, material_size_y, material_count) {

      var iCutCost = 0; //재단비
      var iSalePrice = 0; //판재금액
      var iMaterialPrice = 0; // 자재비? 고정비? 
      var dSpecific_gravity = 0; //철 비중
      var iStaticValue = 0; // 고정금액
      var iWeighted = 0; //가로,세로 가중치


      switch (material_type) {
        case 'SS400':
          iMaterialPrice = 3000;
          iStaticValue = 2000;
          iWeighted = 20;
          dSpecific_gravity = 7.85;
          break;
        case 'ATOS80':
          iMaterialPrice = 1000;
          iStaticValue = 3000;
          iWeighted = 20;
          dSpecific_gravity = 7.85;
          break;
        case 'S45C':
          iMaterialPrice = 1000;
          iStaticValue = 3000;
          iWeighted = 20;
          dSpecific_gravity = 7.85;
          break;
        case 'SUS-1D':
          iMaterialPrice = 1000;
          iStaticValue = 11900;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'SUS-2B':
          iMaterialPrice = 1000;
          iStaticValue = 10000;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'SUS-HL':
          iMaterialPrice = 1000;
          iStaticValue = 11000;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'SUS-PL':
          iMaterialPrice = 1000;
          iStaticValue = 12500;
          iWeighted = 20;
          dSpecific_gravity = 7.93;
          break;
        case 'AL':
          break;
          iMaterialPrice = 1000;
          iStaticValue = 34000;
          iWeighted = 20;
          dSpecific_gravity = 2.75;
        case 'AL-CK':
          iMaterialPrice = 1000;
          iStaticValue = 40000;
          iWeighted = 20;
          dSpecific_gravity = 2.75;
          break;
      }

      iCutCost = iMaterialPrice * material_count;

      // alert("material_size_x : " + material_size_x +"\n"+
      // "material_size_y : " + material_size_y + "\n"+
      // "material_size_t : " + material_size_t + "\n"+
      // "material_count : " + material_count + "\n"+
      // "iWeighted : " + iWeighted + "\n"+
      // "dSpecific_gravity : " + dSpecific_gravity + "\n"+ "\n"+
      // "iStaticValue : " + iStaticValue + "\n");


      material_size_x = parseInt(material_size_x) + iWeighted;
      material_size_y = parseInt(material_size_y) + iWeighted;
      iSalePrice = material_size_x * material_size_y * material_size_t * dSpecific_gravity * material_count / 1000000 * iStaticValue;


      //만원이상
      if (iCutCost > 10000) {
        iCutCost = 0;
      }


      return iCutCost + iSalePrice;
    }

    var insertRowNum = 0;
    function RightTableInert(material_type, material_size, naver_count, payment, material_count) {
      var table = document.getElementById("Table_Right");
      var rowCount = table.rows.length;
      // var row = table.insertRow(rowCount);

      var row = table.insertRow(rowCount - 1);
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
      var cell4 = row.insertCell(3);
      var cell5 = row.insertCell(4);
      var cell6 = row.insertCell(5);
      var cell7 = row.insertCell(6);
      var cell8 = row.insertCell(7);
      var cell9 = row.insertCell(8);
      cell1.innerHTML = rowCount - 1;
      cell2.innerHTML = material_type;//'<th  width="50" min="0" step="1" value = "'.concat(material_type , '" />');
      cell3.innerHTML = material_size;//'<th  width="50" min="0" step="1" value = "'.concat(material_size , '" />');
      cell4.innerHTML = material_count;//'<th  width="50" min="0" step="1" value = "'.concat(naver_count,'" />');
      cell5.innerHTML = "EA";// naver_count;
      cell6.innerHTML = Math.ceil(parseInt(payment.replace(",", "")) / material_count);//"EA";// naver_count;
      cell7.innerHTML = payment;
      cell8.innerHTML = naver_count;

      cell9.innerHTML = '<td><button style = "background-color: gray; height: 30px;width: 10px; font-size: 10px;" onclick="deleteRow(this)">제거</button>'
    }

    function LeftTableInert(material_type, material_size, naver_count) {
      var table = document.getElementById("Table_Left");
      var rowCount = table.rows.length;
      // var row = table.insertRow(rowCount);
      var row = table.insertRow(-1);
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);

      cell1.innerHTML = material_type;//'<th  width="50" min="0" step="1" value = "'.concat(material_type , '" />');
      cell2.innerHTML = material_size;//'<th  width="50" min="0" step="1" value = "'.concat(material_size , '" />');
      cell3.innerHTML = naver_count;//'<th  width="50" min="0" step="1" value = "'.concat(naver_count,'" />');
    }

    
    function myFunction() {
      var table = document.getElementById("myTable");
      var rowCount = table.rows.length;
      //var row = table.insertRow(rowCount);
      var row = table.insertRow(-1);
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
      var cell4 = row.insertCell(3);
      var cell5 = row.insertCell(4);
      var cell6 = row.insertCell(5);

      //@@ 재질 입력 란
      var var_select_value = "<option value='NONE'>재질을 선택해주세요.</option>" +
        "<option value='SS400'> SS400</option>" +
        "<option value='ATOS80'>ATOS80</option>" +
        "<option value='S45C'>S45C</option>" +
        "<option value='SUS-1D'>SUS-1D</option>" +
        "<option value='SUS-2B'>SUS-2B</option>" +
        "<option value='SUS-HL'>SUS-HL</option>" +
        "<option value='SUS-PL'>SUS-PL</option>" +
        "<option value='AL'>AL</option>" +
        "<option value='AL-CK'>AL-CK</option>";


      cell1.innerHTML = "<select onchange=\"doSomething(this);\">" +
        var_select_value
      "</select>";
      // cell2.innerHTML = '<input type="number"  width="50" min="0" step="1"/>';
      // cell3.innerHTML = '<input type="number"  width="50" min="0" step="1"/>';
      // cell4.innerHTML = '<input type="number"  width="50" min="0" step="1"/>';
      cell3.innerHTML = '<input type="number"  width="50" min="0" step="1"/>';
      cell4.innerHTML = '<input type="number"  width="50" min="0" step="1"/>';

      cell5.innerHTML = '<input type="number"  width="50" min="0" step="1"/>';
      cell6.innerHTML = '<td><button onclick="deleteRow(this)">제거</button>'

    }
    function deleteRow(el) {

      // Get the row candidate for deletion
      var row = el.parentNode.parentNode;

      // Get last checked checkbox row, if there is one
      var table = row.parentNode.parentNode;
      var cbs = table.querySelectorAll('input:checked');
      var cbRow = cbs.length ? cbs[cbs.length - 1].parentNode.parentNode : null;

      // If the row to be deleted is the same as the last checked checkbox row
      // don't delete it
      if (row === cbRow) {
        alert("Can't touch this...");

        // Otherwise, delete it
      } else {
        row.parentNode.removeChild(row);
      }

      SetRightTableTotal();
    }
  </script>
</body>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.3/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
  <script>
  //공통
  // 참고 출처 : https://redstapler.co/sheetjs-tutorial-create-xlsx/
  function s2ab(s) { 
      var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer
      var view = new Uint8Array(buf);  //create uint8array as viewer
      for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet
      return buf;    
  }

  $(document).ready(function() { 
      $("#excelFileExport").click(function(){
        downImg();
          //exportExcel();
      });
  });


  

  var excelHandler = {
          getExcelFileName : function(){
              return 'table-test.xlsx';
          },
          getSheetName : function(){
              return 'Table Test Sheet';
          },
          getExcelData : function(){
              return document.getElementById('tableData'); 
          },
          getWorksheet : function(){
              return XLSX.utils.table_to_sheet(this.getExcelData());
          }
  }



  

  function downImg(){

if(iTotalPay < 10000)
{
  alert("최소 주문 금액은 10,000\\ 입니다.");
  
}

      html2canvas($("#right_main")[0]).then(function(canvas){
          var myImage = canvas.toDataURL();

          var date = new Date();
        var year = date.getFullYear().toString();

        var month = date.getMonth() + 1;
        month = month < 10 ? '0' + month.toString() : month.toString();

        var day = date.getDate();
        day = day < 10 ? '0' + day.toString() : day.toString();

        var hour = date.getHours();
        hour = hour < 10 ? '0' + hour.toString() : hour.toString();

        var minites = date.getMinutes();
        minites = minites < 10 ? '0' + minites.toString() : minites.toString();

        var seconds = date.getSeconds();
        seconds = seconds < 10 ? '0' + seconds.toString() : seconds.toString();

        var str_time  =year + month + day + hour + minites;

            //var str_time = `${year}_ ${date}` + `${hours < 10 ? `0${hours}` : hours}:${minutes < 10 ? `0${minutes}` : minutes}:${seconds < 10 ? `0${seconds}` : seconds}`; 

     
          downloadURI(myImage, str_time+"_레이저마켓_견적서.png") 
      });
  }

  function downloadURI(uri, name){
      var link = document.createElement("a")
      link.download = name;
      link.href = uri;
      document.body.appendChild(link);
      link.click();
  }

 
 
  function exportExcel(){ 
    alert("출력");
    try
    {

      // var table2excel = new Table2Excel();
      // table2excel.expert(document.querySelectorAll("#Table_Right"));
      var wb = XLSX.utils.table_to_book(document.getElementById('Table_Right'), {sheet:"견적",raw:true});
XLSX.writeFile(wb, ('레이저마켓견적파일.xlsx'));
    }catch(error)
    {
      alert(error);
    }
    
      
  }
  $(function() {
                $("#Table_Right").table2excel({
                    name: "Excel table",
                    filename: "excel table",
                    fileext: ".xls",
                    exclude_img: true,
                    exclude_links: true,
                    exclude_inputs: true
                });
            });
  </script>



</html>